name: sdk-java Verify

on:
  push:
    branches:
      - main
  pull_request:
    branches:
      - main

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
      # 1. Checkout this repo
      - name: Checkout sdk-java
        uses: actions/checkout@v4

      # 2. Set up JDK 17 for both builds
      - name: Set up JDK 17
        uses: actions/setup-java@v4
        with:
          distribution: temurin
          java-version: 17
          cache: 'maven'

      - name: Check formatting
        run: |
          make ci

      # 3. Verify the main sdk-java project, excluding the two agentic modules
      - name: Verify with Maven
        run: |
          mvn -B -f pom.xml clean install verify -am

      # 4. Verify examples
      - name: Verify Examples with Maven
        run: |
          mvn -B -f examples/pom.xml clean install verify
